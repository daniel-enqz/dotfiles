"use strict";(self.webpackChunkvscode_pull_request_github=self.webpackChunkvscode_pull_request_github||[]).push([[391],{63391:(cr,Vn,nn)=>{nn.r(Vn),nn.d(Vn,{BE_PROFILE:()=>ee,NRT_PROFILE:()=>ne,PostChannel:()=>or,RT_PROFILE:()=>Tn});var he=nn(27421),bn=nn(29141),fn=nn(81782),vn=nn(47954),ke=nn(87624),_=nn(65705),l=nn(24869),en=nn(49251),dn=nn(28452),An=nn(29339),Ce=nn(87951),Tn="REAL_TIME",ne="NEAR_REAL_TIME",ee="BEST_EFFORT",Qn="POST",He="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",In="drop",Oe="send",re="requeue",Le="rspFail",ze="oth",Ke="no-cache, no-store",ie="application/x-json-stream",te="cache-control",Nn="content-type",Fe="kill-tokens",ae="kill-duration",Ue="kill-duration-seconds",ue="time-delta-millis",Pn="client-version",se="client-id",Wn="time-delta-to-apply-millis",Xn="upload-time",jn="apikey",Bn="AuthMsaDeviceTicket",oe="AuthXToken",lr="sdk-version",_e="NoResponseBody",On="msfpc";function fe(v){var m=(v.ext||{}).intweb;return m&&(0,_.Sn)(m[On])?m[On]:null}function ce(v){for(var m=null,b=0;m===null&&b<v.length;b++)m=fe(v[b]);return m}var Ln=function(){function v(m,b){var o=b?[].concat(b):[],C=this,h=ce(o);C.iKey=function(){return m},C.Msfpc=function(){return h||""},C.count=function(){return o.length},C.events=function(){return o},C.addEvent=function(c){return c?(o.push(c),h||(h=fe(c)),!0):!1},C.split=function(c,O){var z;if(c<o.length){var y=o.length-c;(0,l.le)(O)||(y=O<y?O:y),z=o.splice(c,y),h=ce(o)}return new v(m,z)}}return v.create=function(m,b){return new v(m,b)},v}(),ye=nn(1550),qe=20,De=3984588,le=65e3,ve=2e6,Qe=Math.min(ve,le),de="metadata",zn="f",Ie=/\./,Ne=function(){function v(m,b,o,C){var h="data",c="baseData",O="ext",z=!!C,y=!0,Z=b,rn={};(0,bn.Z)(v,this,function(U){U.createPayload=function(x,R,F,D,w,H){return{apiKeys:[],payloadBlob:"",overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:x,isTeardown:R,isSync:F,isBeacon:D,sendType:H,sendReason:w}},U.appendPayload=function(x,R,F){var D=x&&R&&!x.overflow;return D&&(0,fn.Lm)(m,function(){return"Serializer:appendPayload"},function(){for(var w=R.events(),H=x.payloadBlob,N=x.numEvents,L=!1,K=[],W=[],B=x.isBeacon,A=B?le:De,Y=B?Qe:ve,Q=0,J=0;Q<w.length;){var I=w[Q];if(I){if(N>=F){x.overflow=R.split(Q);break}var p=U.getEventBlob(I);if(p&&p.length<=Y){var j=p.length,pn=H.length;if(pn+j>A){x.overflow=R.split(Q);break}H&&(H+=`
`),H+=p,J++,J>qe&&(H.substr(0,1),J=0),L=!0,N++}else p?K.push(I):W.push(I),w.splice(Q,1),Q--}Q++}if(K&&K.length>0&&x.sizeExceed.push(Ln.create(R.iKey(),K)),W&&W.length>0&&x.failedEvts.push(Ln.create(R.iKey(),W)),L){x.batches.push(R),x.payloadBlob=H,x.numEvents=N;var V=R.iKey();(0,l.UA)(x.apiKeys,V)===-1&&x.apiKeys.push(V)}},function(){return{payload:x,theBatch:{iKey:R.iKey(),evts:R.events()},max:F}}),D},U.getEventBlob=function(x){try{return(0,fn.Lm)(m,function(){return"Serializer.getEventBlob"},function(){var R={};R.name=x.name,R.time=x.time,R.ver=x.ver,R.iKey="o:"+(0,_.jM)(x.iKey);var F={},D=x[O];D&&(R[O]=F,(0,l.rW)(D,function(N,L){var K=F[N]={};q(L,K,"ext."+N,!0,null,null,!0)}));var w=R[h]={};w.baseType=x.baseType;var H=w[c]={};return q(x.baseData,H,c,!1,[c],function(N,L,K){ge(F,N,L,K)},y),q(x.data,w,h,!1,[],function(N,L,K){ge(F,N,L,K)},y),JSON.stringify(R)},function(){return{item:x}})}catch(R){return null}};function X(x,R){var F=rn[x];return F===void 0&&(x.length>=7&&(F=(0,l.xe)(x,"ext.metadata")||(0,l.xe)(x,"ext.web")),rn[x]=F),F}function q(x,R,F,D,w,H,N){(0,l.rW)(x,function(L,K){var W=null;if(K||(0,_.Sn)(K)){var B=F,A=L,Y=w,Q=R;if(z&&!D&&Ie.test(L)){var J=L.split("."),I=J.length;if(I>1){Y&&(Y=Y.slice());for(var p=0;p<I-1;p++){var j=J[p];Q=Q[j]=Q[j]||{},B+="."+j,Y&&Y.push(j)}A=J[I-1]}}var pn=D&&X(B,A);if(!pn&&Z&&Z.handleField(B,A)?W=Z.value(B,A,K,o):W=(0,_.yj)(A,K,o),W){var V=W.value;if(Q[A]=V,H&&H(Y,A,W),N&&typeof V=="object"&&!(0,l.kJ)(V)){var an=Y;an&&(an=an.slice(),an.push(A)),q(K,V,B+"."+A,D,an,H,N)}}}})}})}return v}();function ge(v,m,b,o){if(o&&v){var C=(0,_.Vv)(o.value,o.kind,o.propertyType);if(C>-1){var h=v[de];h||(h=v[de]={f:{}});var c=h[zn];if(c||(c=h[zn]={}),m)for(var O=0;O<m.length;O++){var z=m[O];c[z]||(c[z]={f:{}});var y=c[z][zn];y||(y=c[z][zn]={}),c=y}c=c[b]={},(0,l.kJ)(o.value)?c.a={t:C}:c.t=C}}}var Pe=.8,We=1.2,me=3e3,Xe=6e5;function je(v){return!(v>=300&&v<500&&v!=408&&v!=429||v==501||v==505)}function Se(v){var m=0,b=me*Pe,o=me*We,C=Math.floor(Math.random()*(o-b))+b;return m=Math.pow(2,v)*C,Math.min(m,Xe)}var Be=1e3,Je=function(){function v(){var m={};function b(o){var C=[];return o&&(0,l.tO)(o,function(h){C.push((0,l.nd)(h))}),C}(0,bn.Z)(v,this,function(o){o.setKillSwitchTenants=function(C,h){if(C&&h)try{var c=b(C.split(","));if(h==="this-request-only")return c;for(var O=parseInt(h,10)*Be,z=0;z<c.length;++z)m[c[z]]=(0,l.m6)()+O}catch(y){return[]}return[]},o.isTenantKilled=function(C){var h=m,c=(0,l.nd)(C);return h[c]!==void 0&&h[c]>(0,l.m6)()?!0:(delete h[c],!1)}})}return v}();const Ze=Je;var Ye=function(){function v(){var m=!0,b=!0,o=!0,C="use-collector-delta",h=!1;(0,bn.Z)(v,this,function(c){c.allowRequestSending=function(){return m},c.firstRequestSent=function(){o&&(o=!1,h||(m=!1))},c.shouldAddClockSkewHeaders=function(){return b},c.getClockSkewHeaderValue=function(){return C},c.setClockSkew=function(O){h||(O?(C=O,b=!0,h=!0):b=!1,m=!0)}})}return v}();const Ge=Ye;var gn,Jn="sendAttempt",pe="&"+_e+"=true",$e=(gn={},gn[1]=re,gn[100]=re,gn[200]="sent",gn[8004]=In,gn[8003]=In,gn),Zn={},Yn={};function mn(v,m,b){Zn[v]=m,b!==!1&&(Yn[m]=v)}mn(Bn,Bn,!1),mn(Pn,Pn),mn(se,"Client-Id"),mn(jn,jn),mn(Wn,Wn),mn(Xn,Xn),mn(oe,oe);function xe(v){try{return v.responseText}catch(m){}return""}function Me(v,m){var b=!1;if(v&&m){var o=(0,l.FY)(v);if(o&&o.length>0)for(var C=m.toLowerCase(),h=0;h<o.length;h++){var c=o[h];if(c&&(0,l.nr)(m,c)&&c.toLowerCase()===C){b=!0;break}}}return b}function En(v,m,b,o){m&&b&&b.length>0&&(o&&Zn[m]?(v.hdrs[Zn[m]]=b,v.useHdrs=!0):v.url+="&"+m+"="+b)}var Ve=function(){function v(m,b,o,C,h){this._responseHandlers=[];var c="?cors=true&"+Nn.toLowerCase()+"="+ie,O=new Ze,z=!1,y=new Ge,Z=!1,rn=0,U,X,q,x=!0,R=[],F={},D=[],w=null,H=!1,N,L=!1,K=!1,W,B;(0,bn.Z)(v,this,function(A){var Y=!0;A.initialize=function(n,i,t,u,f){var T;f||(f={}),c=n+c,K=(0,l.o8)(f.avoidOptions)?!0:!f.avoidOptions,q=i,N=i.getCookieMgr(),H=!q.config.disableEventTimings;var M=!!q.config.enableCompoundKey;U=t;var k=f.valueSanitizer,E=f.stringifyObjects;(0,l.o8)(f.enableCompoundKey)||(M=!!f.enableCompoundKey),W=f.xhrTimeout,B=f.disableXhrSync,Z=!(0,en.b$)(),w=new Ne(q,k,E,M);var d=u,e=f.alwaysUseXhrOverride?u:null,r=f.alwaysUseXhrOverride?u:null;if(!u){x=!1;var a=(0,en.k$)();a&&a.protocol&&a.protocol.toLowerCase()==="file:"&&(Y=!1);var s=[];(0,en.b$)()?s=[2,1]:s=[1,2,3];var g=f.transports;g&&((0,l.hj)(g)?s=[g].concat(s):(0,l.kJ)(g)&&(s=g.concat(s))),u=Q(s,!1),d=Q(s,!0),u||U.diagLog().warnToConsole("No available transport to send events")}X=(T={},T[0]=u,T[1]=d||Q([1,2,3],!0),T[2]=e||Q([3,2],!0)||d||Q([1],!0),T[3]=r||Q([2,3],!0)||d||Q([1],!0),T)};function Q(n,i){for(var t=0,u=null,f=0;u==null&&f<n.length;)t=n[f],t===1?(0,en.cp)()?u=J:(0,en.Z3)()&&(u=p):t===2&&(0,en.JO)(i)?u=I:Z&&t===3&&(0,en.MF)()&&(u=pn),f++;return u?{_transport:t,_isSync:i,sendPOST:u}:null}A._getDbgPlgTargets=function(){return[X[0],O,w,X]};function J(n,i,t){var u=new XDomainRequest;u.open(Qn,n.urlString),n.timeout&&(u.timeout=n.timeout),u.onload=function(){var f=xe(u);j(i,200,{},f),Rn(f)},u.onerror=function(){j(i,400,{})},u.ontimeout=function(){j(i,500,{})},u.onprogress=function(){},t?u.send(n.data):h.set(function(){u.send(n.data)},0)}function I(n,i,t){var u,f=n.urlString,T=!1,M=!1,k=(u={body:n.data,method:Qn},u[He]=!0,u);t&&(k.keepalive=!0,n._sendReason===2&&(T=!0,f+=pe)),Y&&(k.credentials="include"),n.headers&&(0,l.FY)(n.headers).length>0&&(k.headers=n.headers),fetch(f,k).then(function(E){var d={},e="";E.headers&&E.headers.forEach(function(r,a){d[a]=r}),E.body&&E.text().then(function(r){e=r}),M||(M=!0,j(i,E.status,d,e),Rn(e))}).catch(function(E){M||(M=!0,j(i,0,{}))}),T&&!M&&(M=!0,j(i,200,{})),!M&&n.timeout>0&&h.set(function(){M||(M=!0,j(i,500,{}))},n.timeout)}function p(n,i,t){var u=n.urlString;function f(E,d,e){if(!E[e]&&d&&d.getResponseHeader){var r=d.getResponseHeader(e);r&&(E[e]=(0,l.nd)(r))}return E}function T(E){var d={};return E.getAllResponseHeaders?d=Hn(E.getAllResponseHeaders()):(d=f(d,E,ue),d=f(d,E,ae),d=f(d,E,Ue)),d}function M(E,d){j(i,E.status,T(E),d)}t&&n.disableXhrSync&&(t=!1);var k=(0,_.ot)(Qn,u,Y,!0,t,n.timeout);(0,l.rW)(n.headers,function(E,d){k.setRequestHeader(E,d)}),k.onload=function(){var E=xe(k);M(k,E),Rn(E)},k.onerror=function(){M(k)},k.ontimeout=function(){M(k)},k.send(n.data)}function j(n,i,t,u){try{n(i,t,u)}catch(f){(0,An.kP)(U.diagLog(),2,518,(0,en.eU)(f))}}function pn(n,i,t){var u=n,f=200,T=u._thePayload,M=n.urlString+pe;try{var k=(0,en.jW)();if(!k.sendBeacon(M,n.data))if(T){var E=[];(0,l.tO)(T.batches,function(d){if(E&&d&&d.count()>0){for(var e=d.events(),r=0;r<e.length;r++)if(!k.sendBeacon(M,w.getEventBlob(e[r]))){E.push(d.split(r));break}}else E.push(d.split(0))}),sn(E,8003,T.sendType,!0)}else f=0}catch(d){U.diagLog().warnToConsole("Failed to send telemetry using sendBeacon API. Ex:"+(0,en.eU)(d)),f=0}finally{j(i,f,{},"")}}function V(n){return n===2||n===3}function an(n){return L&&V(n)&&(n=2),n}A.addQueryStringParameter=function(n,i){for(var t=0;t<R.length;t++)if(R[t].name===n){R[t].value=i;return}R.push({name:n,value:i})},A.addHeader=function(n,i){F[n]=i},A.canSendRequest=function(){return wn()&&y.allowRequestSending()},A.sendQueuedRequests=function(n,i){(0,l.o8)(n)&&(n=0),L&&(n=an(n),i=2),hn(D,n,0)&&xn(ln(),0,!1,n,i||0)},A.isCompletelyIdle=function(){return!z&&rn===0&&D.length===0},A.setUnloading=function(n){L=n},A.addBatch=function(n){if(n&&n.count()>0){if(O.isTenantKilled(n.iKey()))return!1;D.push(n)}return!0},A.teardown=function(){D.length>0&&xn(ln(),0,!0,2,2)},A.pause=function(){z=!0},A.resume=function(){z=!1,A.sendQueuedRequests(0,4)},A.sendSynchronousBatch=function(n,i,t){n&&n.count()>0&&((0,l.le)(i)&&(i=1),L&&(i=an(i),t=2),xn([n],0,!1,i,t||0))};function wn(){return!z&&rn<b}function ln(){var n=D;return D=[],n}function hn(n,i,t){var u=!1;return n&&n.length>0&&!z&&X[i]&&w&&(u=i!==0||wn()&&(t>0||y.allowRequestSending())),u}function $(n){var i={};return n&&(0,l.tO)(n,function(t,u){i[u]={iKey:t.iKey(),evts:t.events()}}),i}function xn(n,i,t,u,f){if(!(!n||n.length===0)){if(z){sn(n,1,u);return}u=an(u);try{var T=n,M=u!==0;(0,fn.Lm)(q,function(){return"HttpManager:_sendBatches"},function(k){k&&(n=n.slice(0));for(var E=[],d=null,e=(0,_.hK)(),r=X[u]||(M?X[1]:X[0]),a=(L||V(u)||r&&r._transport===3)&&un();hn(n,u,i);){var s=n.shift();s&&s.count()>0&&(O.isTenantKilled(s.iKey())?E.push(s):(d=d||w.createPayload(i,t,M,a,f,u),w.appendPayload(d,s,m)?d.overflow!==null&&(n=[d.overflow].concat(n),d.overflow=null,kn(d,e,(0,_.hK)(),f),e=(0,_.hK)(),d=null):(kn(d,e,(0,_.hK)(),f),e=(0,_.hK)(),n=[s].concat(n),d=null)))}d&&kn(d,e,(0,_.hK)(),f),n.length>0&&(D=n.concat(D)),sn(E,8004,u)},function(){return{batches:$(T),retryCount:i,isTeardown:t,isSynchronous:M,sendReason:f,useSendBeacon:V(u),sendType:u}},!M)}catch(k){(0,An.kP)(U.diagLog(),2,48,"Unexpected Exception sending batch: "+(0,en.eU)(k))}}}function Mn(n,i){var t={url:c,hdrs:{},useHdrs:!1};i?(t.hdrs=(0,_.l7)(t.hdrs,F),t.useHdrs=(0,l.FY)(t.hdrs).length>0):(0,l.rW)(F,function(k,E){Yn[k]?En(t,Yn[k],E,!1):(t.hdrs[k]=E,t.useHdrs=!0)}),En(t,se,"NO_AUTH",i),En(t,Pn,_.vs,i);var u="";(0,l.tO)(n.apiKeys,function(k){u.length>0&&(u+=","),u+=k}),En(t,jn,u,i),En(t,Xn,(0,l.m6)().toString(),i);var f=qn(n);if((0,_.Sn)(f)&&(t.url+="&ext.intweb.msfpc="+f),y.shouldAddClockSkewHeaders()&&En(t,Wn,y.getClockSkewHeaderValue(),i),q.getWParam){var T=q.getWParam();T>=0&&(t.url+="&w="+T)}for(var M=0;M<R.length;M++)t.url+="&"+R[M].name+"="+R[M].value;return t}function un(){return!x&&Z&&(0,en.MF)()}function cn(n,i,t){n[i]=n[i]||{},n[i][U.identifier]=t}function kn(n,i,t,u){if(n&&n.payloadBlob&&n.payloadBlob.length>0){var f=!!A.sendHook,T=X[n.sendType];!V(n.sendType)&&n.isBeacon&&n.sendReason===2&&(T=X[2]||X[3]||T);var M=K;(n.isBeacon||T._transport===3)&&(M=!1);var k=Mn(n,M);M=M||k.useHdrs;var E=(0,_.hK)();(0,fn.Lm)(q,function(){return"HttpManager:_doPayloadSend"},function(){for(var d=0;d<n.batches.length;d++)for(var e=n.batches[d],r=e.events(),a=0;a<r.length;a++){var s=r[a];if(H){var g=s.timings=s.timings||{};cn(g,"sendEventStart",E),cn(g,"serializationStart",i),cn(g,"serializationCompleted",t)}s[Jn]>0?s[Jn]++:s[Jn]=1}sn(n.batches,1e3+(u||0),n.sendType,!0);var S={data:n.payloadBlob,urlString:k.url,headers:k.hdrs,_thePayload:n,_sendReason:u,timeout:W};(0,l.o8)(B)||(S.disableXhrSync=!!B),M&&(Me(S.headers,te)||(S.headers[te]=Ke),Me(S.headers,Nn)||(S.headers[Nn]=ie));var P=null;T&&(P=function(G){y.firstRequestSent();var tn=function($n,fr){_n($n,fr,n,u)},on=n.isTeardown||n.isSync;try{T.sendPOST(G,tn,on),A.sendListener&&A.sendListener(S,G,on,n.isBeacon)}catch($n){U.diagLog().warnToConsole("Unexpected exception sending payload. Ex:"+(0,en.eU)($n)),j(tn,0,{})}}),(0,fn.Lm)(q,function(){return"HttpManager:_doPayloadSend.sender"},function(){if(P)if(n.sendType===0&&rn++,f&&!n.isBeacon&&T._transport!==3){var G={data:S.data,urlString:S.urlString,headers:(0,_.l7)({},S.headers),timeout:S.timeout,disableXhrSync:S.disableXhrSync},tn=!1;(0,fn.Lm)(q,function(){return"HttpManager:_doPayloadSend.sendHook"},function(){try{A.sendHook(G,function(on){tn=!0,!x&&!on._thePayload&&(on._thePayload=on._thePayload||S._thePayload,on._sendReason=on._sendReason||S._sendReason),P(on)},n.isSync||n.isTeardown)}catch(on){tn||P(S)}})}else P(S)})},function(){return{thePayload:n,serializationStart:i,serializationCompleted:t,sendReason:u}},n.isSync)}n.sizeExceed&&n.sizeExceed.length>0&&sn(n.sizeExceed,8003,n.sendType),n.failedEvts&&n.failedEvts.length>0&&sn(n.failedEvts,8002,n.sendType)}function Un(n,i){H&&(0,l.tO)(n,function(t){var u=t.timings=t.timings||{};cn(u,"sendEventCompleted",i)})}function _n(n,i,t,u){var f=9e3,T=null,M=!1,k=!1;try{var E=!0;if(typeof n!==ye.jA){if(i){y.setClockSkew(i[ue]);var d=i[ae]||i["kill-duration-seconds"];(0,l.tO)(O.setKillSwitchTenants(i[Fe],d),function(r){(0,l.tO)(t.batches,function(a){if(a.iKey()===r){T=T||[];var s=a.split(0);t.numEvents-=s.count(),T.push(s)}})})}if(n==200||n==204){f=200;return}(!je(n)||t.numEvents<=0)&&(E=!1),f=9e3+n%1e3}if(E){f=100;var e=t.retryCnt;t.sendType===0&&(e<o?(M=!0,Cn(function(){t.sendType===0&&rn--,xn(t.batches,e+1,t.isTeardown,L?2:t.sendType,5)},L,Se(e))):(k=!0,L&&(f=8001)))}}finally{M||(y.setClockSkew(),yn(t,f,u,k)),sn(T,8004,t.sendType)}}function yn(n,i,t,u){try{u&&U._backOffTransmission(),i===200&&(!u&&!n.isSync&&U._clearBackOff(),Gn(n.batches)),sn(n.batches,i,n.sendType,!0)}finally{n.sendType===0&&(rn--,t!==5&&A.sendQueuedRequests(n.sendType,t))}}function Gn(n){if(H){var i=(0,_.hK)();(0,l.tO)(n,function(t){t&&t.count()>0&&Un(t.events(),i)})}}function Cn(n,i,t){i?n():h.set(n,t)}function Hn(n){var i={};if((0,l.HD)(n)){var t=(0,l.nd)(n).split(/[\r\n]+/);(0,l.tO)(t,function(u){if(u){var f=u.indexOf(": ");if(f!==-1){var T=(0,l.nd)(u.substring(0,f)).toLowerCase(),M=(0,l.nd)(u.substring(f+1));i[T]=M}else i[(0,l.nd)(u)]=1}})}return i}function qn(n){for(var i=0;i<n.batches.length;i++){var t=n.batches[i].Msfpc();if(t)return encodeURIComponent(t)}return""}function Rn(n){var i=A._responseHandlers;try{for(var t=0;t<i.length;t++)try{i[t](n)}catch(f){(0,An.kP)(U.diagLog(),1,519,"Response handler failed: "+f)}if(n){var u=JSON.parse(n);(0,_.Sn)(u.webResult)&&(0,_.Sn)(u.webResult[On])&&N.set("MSFPC",u.webResult[On],365*86400)}}catch(f){}}function sn(n,i,t,u){if(n&&n.length>0&&C){var f=C[Dn(i)];if(f){var T=t!==0;(0,fn.Lm)(q,function(){return"HttpManager:_sendBatchesNotification"},function(){Cn(function(){try{f.call(C,n,i,T,t)}catch(M){(0,An.kP)(U.diagLog(),1,74,"send request notification failed: "+M)}},u||T,0)},function(){return{batches:$(n),reason:i,isSync:T,sendSync:u,sendType:t}},!T)}}}function Dn(n){var i=$e[n];return(0,_.Sn)(i)||(i=ze,n>=9e3&&n<=9999?i=Le:n>=8e3&&n<=8999?i=In:n>=1e3&&n<=1999&&(i=Oe)),i}})}return v}();function nr(v,m){for(var b=[],o=2;o<arguments.length;o++)b[o-2]=arguments[o];return setTimeout(v,m,b)}function er(v){clearTimeout(v)}function Kn(v,m){return{set:v||nr,clear:m||er}}var rr=.25,Ee=500,ir=20,Re=6,be=2,tr=4,Ae=2,ar=1,Sn="eventsDiscarded",Fn="overrideInstrumentationKey",Te="maxEventRetryAttempts",we="maxUnloadEventRetryAttempts",ur="addUnloadCb",sr=function(v){(0,he.ne)(m,v);function m(){var b=v.call(this)||this;b.identifier="PostChannel",b.priority=1011,b.version="3.2.3";var o,C=!1,h=[],c=null,O=!1,z=0,y=500,Z=0,rn=1e4,U={},X=Tn,q=null,x=null,R=0,F=0,D,w,H={},N,L,K=-1,W,B=!0,A=!1,Y=Re,Q=be,J,I;return(0,bn.Z)(m,b,function(p,j){xn(),p._getDbgPlgTargets=function(){return[w]},p.initialize=function(e,r,a){(0,fn.Lm)(r,function(){return"PostChannel:initialize"},function(){var s=r;j.initialize(e,r,a);try{var g=!!r[ur];J=(0,vn.jU)((0,ke.J)(p.identifier),r.evtNamespace&&r.evtNamespace());var S=p._getTelCtx();e.extensionConfig[p.identifier]=e.extensionConfig[p.identifier]||{},o=S.getExtCfg(p.identifier),I=Kn(o.setTimeoutOverride,o.clearTimeoutOverride),B=!o.disableOptimizeObj&&(0,_.mJ)(),pn(s),o.eventsLimitInMem>0&&(rn=o.eventsLimitInMem),o.immediateEventLimit>0&&(y=o.immediateEventLimit),o.autoFlushEventsLimit>0&&(N=o.autoFlushEventsLimit),(0,l.hj)(o[Te])&&(Y=o[Te]),(0,l.hj)(o[we])&&(Q=o[we]),d(),o.httpXHROverride&&o.httpXHROverride.sendPOST&&(D=o.httpXHROverride),(0,_.Sn)(e.anonCookieName)&&w.addQueryStringParameter("anoncknm",e.anonCookieName),w.sendHook=o.payloadPreprocessor,w.sendListener=o.payloadListener;var P=o.overrideEndpointUrl?o.overrideEndpointUrl:e.endpointUrl;p._notificationManager=e.extensionConfig.NotificationManager,w.initialize(P,p.core,p,D,o);var G=e.disablePageUnloadEvents||[];(0,vn.c9)(V,G,J),(0,vn.TJ)(V,G,J),(0,vn.nD)(an,e.disablePageShowEvents,J)}catch(tn){throw p.setInitialized(!1),tn}},function(){return{coreConfig:e,core:r,extensions:a}})},p.processTelemetry=function(e,r){(0,_.if)(e,p.identifier),r=p._getTelCtx(r);var a=r.getExtCfg(p.identifier),s=!!o.disableTelemetry;a&&(s=s||!!a.disableTelemetry);var g=e;!s&&!C&&(o[Fn]&&(g.iKey=o[Fn]),a&&a[Fn]&&(g.iKey=a[Fn]),wn(g,!0),A?cn(2,2):$()),p.processNext(g,r)},p._doTeardown=function(e,r){cn(2,2),C=!0,w.teardown(),(0,vn.JA)(null,J),(0,vn.C9)(null,J),(0,vn.Yl)(null,J),xn()};function pn(e){var r=e.getWParam;e.getWParam=function(){var a=0;return o.ignoreMc1Ms0CookieProcessing&&(a=a|2),a|r()}}function V(e){var r=e||(0,en.Jj)().event;r.type!=="beforeunload"&&(A=!0,w.setUnloading(A)),cn(2,2)}function an(e){A=!1,w.setUnloading(A)}function wn(e,r){if(e.sendAttempt||(e.sendAttempt=0),e.latency||(e.latency=1),e.ext&&e.ext.trace&&delete e.ext.trace,e.ext&&e.ext.user&&e.ext.user.id&&delete e.ext.user.id,B&&(e.ext=(0,l.Ax)(e.ext),e.baseData&&(e.baseData=(0,l.Ax)(e.baseData)),e.data&&(e.data=(0,l.Ax)(e.data))),e.sync){if(R||O)e.latency=3,e.sync=!1;else if(w){B&&(e=(0,l.Ax)(e)),w.sendSynchronousBatch(Ln.create(e.iKey,[e]),e.sync===!0?1:e.sync,3);return}}var a=e.latency,s=Z,g=rn;a===4&&(s=z,g=y);var S=!1;if(s<g)S=!yn(e,r);else{var P=1,G=ir;a===4&&(P=4,G=1),S=!0,Gn(e.iKey,e.latency,P,G)&&(S=!yn(e,r))}S&&t(Sn,[e],dn.h.QueueFull)}p.setEventQueueLimits=function(e,r){rn=e>0?e:1e4,N=r>0?r:0,d();var a=Z>e;if(!a&&L>0)for(var s=1;!a&&s<=3;s++){var g=H[s];g&&g.batches&&(0,l.tO)(g.batches,function(S){S&&S.count()>=L&&(a=!0)})}_n(!0,a)},p.pause=function(){un(),O=!0,w.pause()},p.resume=function(){O=!1,w.resume(),$()},p.addResponseHandler=function(e){w._responseHandlers.push(e)},p._loadTransmitProfiles=function(e){sn(),(0,l.rW)(e,function(r,a){var s=a.length;if(s>=2){var g=s>2?a[2]:0;if(a.splice(0,s-2),a[1]<0&&(a[0]=-1),a[1]>0&&a[0]>0){var S=a[0]/a[1];a[0]=Math.ceil(S)*a[1]}g>=0&&a[1]>=0&&g>a[1]&&(g=a[1]),a.push(g),U[r]=a}})},p.flush=function(e,r,a){if(e===void 0&&(e=!0),!O)if(a=a||1,e)c==null?(un(),Hn(1,0,a),c=Mn(function(){c=null,qn(r,a)},0)):h.push(r);else{var s=un();ln(1,1,a),r!=null&&r(),s&&$()}},p.setMsaAuthTicket=function(e){w.addHeader(Bn,e)},p.hasEvents=hn,p._setTransmitProfile=function(e){X!==e&&U[e]!==void 0&&(un(),X=e,$())};function ln(e,r,a){var s=Hn(e,r,a);return w.sendQueuedRequests(r,a),s}function hn(){return Z>0}function $(){if(K>=0&&Hn(K,0,W)&&w.sendQueuedRequests(0,W),z>0&&!x&&!O){var e=U[X][2];e>=0&&(x=Mn(function(){x=null,ln(4,0,1),$()},e))}var r=U[X][1];!q&&!c&&r>=0&&!O&&(hn()?q=Mn(function(){q=null,ln(F===0?3:1,0,1),F++,F%=2,$()},r):F=0)}p._backOffTransmission=function(){R<tr&&(R++,un(),$())},p._clearBackOff=function(){R&&(R=0,un(),$())};function xn(){o=null,C=!1,h=[],c=null,O=!1,z=0,y=500,Z=0,rn=1e4,U={},X=Tn,q=null,x=null,R=0,F=0,D=null,H={},N=void 0,L=0,K=-1,W=null,B=!0,A=!1,Y=Re,Q=be,J=null,I=Kn(),w=new Ve(Ee,Ae,ar,{requeue:n,send:f,sent:T,drop:M,rspFail:k,oth:E},I),Dn(),kn(),d()}function Mn(e,r){r===0&&R&&(r=1);var a=1e3;return R&&(a=Se(R-1)),I.set(e,r*a)}function un(){return q!==null?(I.clear(q),q=null,F=0,!0):!1}function cn(e,r){un(),c&&(I.clear(c),c=null),O||ln(1,e,r)}function kn(){H[4]={batches:[],iKeyMap:{}},H[3]={batches:[],iKeyMap:{}},H[2]={batches:[],iKeyMap:{}},H[1]={batches:[],iKeyMap:{}}}function Un(e,r,a){var s=H[r];s||(r=1,s=H[r]);var g=s.iKeyMap[e];return!g&&a&&(g=Ln.create(e),s.batches.push(g),s.iKeyMap[e]=g),g}function _n(e,r){w.canSendRequest()&&!R&&(N>0&&Z>N&&(r=!0),r&&c==null&&p.flush(e,null,20))}function yn(e,r){B&&(e=(0,l.Ax)(e));var a=e.latency,s=Un(e.iKey,a,!0);return s.addEvent(e)?(a!==4?(Z++,r&&e.sendAttempt===0&&_n(!e.sync,L>0&&s.count()>=L)):z++,!0):!1}function Gn(e,r,a,s){for(;a<=r;){var g=Un(e,r,!0);if(g&&g.count()>0){var S=g.split(0,s),P=S.count();if(P>0)return a===4?z-=P:Z-=P,u(Sn,[S],dn.h.QueueFull),!0}a++}return Cn(),!1}function Cn(){for(var e=0,r=0,a=function(g){var S=H[g];S&&S.batches&&(0,l.tO)(S.batches,function(P){g===4?e+=P.count():r+=P.count()})},s=1;s<=4;s++)a(s);Z=r,z=e}function Hn(e,r,a){var s=!1,g=r===0;return!g||w.canSendRequest()?(0,fn.Lm)(p.core,function(){return"PostChannel._queueBatches"},function(){for(var S=[],P=4;P>=e;){var G=H[P];G&&G.batches&&G.batches.length>0&&((0,l.tO)(G.batches,function(tn){w.addBatch(tn)?s=s||tn&&tn.count()>0:S=S.concat(tn.events()),P===4?z-=tn.count():Z-=tn.count()}),G.batches=[],G.iKeyMap={}),P--}S.length>0&&t(Sn,S,dn.h.KillSwitch),s&&K>=e&&(K=-1,W=0)},function(){return{latency:e,sendType:r,sendReason:a}},!g):(K=K>=0?Math.min(K,e):e,W=Math.max(W,a)),s}function qn(e,r){ln(1,0,r),Cn(),Rn(function(){e&&e(),h.length>0?c=Mn(function(){c=null,qn(h.shift(),r)},0):(c=null,$())})}function Rn(e){w.isCompletelyIdle()?e():c=Mn(function(){c=null,Rn(e)},rr)}function sn(){un(),Dn(),X=Tn,$()}function Dn(){U={},U[Tn]=[2,1,0],U[ne]=[6,3,0],U[ee]=[18,9,0]}function n(e,r){var a=[],s=Y;A&&(s=Q),(0,l.tO)(e,function(g){g&&g.count()>0&&(0,l.tO)(g.events(),function(S){S&&(S.sync&&(S.latency=4,S.sync=!1),S.sendAttempt<s?((0,_.if)(S,p.identifier),wn(S,!1)):a.push(S))})}),a.length>0&&t(Sn,a,dn.h.NonRetryableStatus),A&&cn(2,2)}function i(e,r){var a=p._notificationManager||{},s=a[e];if(s)try{s.apply(a,r)}catch(g){(0,An.kP)(p.diagLog(),1,74,e+" notification failed: "+g)}}function t(e,r){for(var a=[],s=2;s<arguments.length;s++)a[s-2]=arguments[s];r&&r.length>0&&i(e,[r].concat(a))}function u(e,r){for(var a=[],s=2;s<arguments.length;s++)a[s-2]=arguments[s];r&&r.length>0&&(0,l.tO)(r,function(g){g&&g.count()>0&&i(e,[g.events()].concat(a))})}function f(e,r,a){e&&e.length>0&&i("eventsSendRequest",[r>=1e3&&r<=1999?r-1e3:0,a!==!0])}function T(e,r){u("eventsSent",e,r),$()}function M(e,r){u(Sn,e,r>=8e3&&r<=8999?r-8e3:dn.h.Unknown)}function k(e){u(Sn,e,dn.h.NonRetryableStatus),$()}function E(e,r){u(Sn,e,dn.h.Unknown),$()}function d(){!o||!o.disableAutoBatchFlushLimit?L=Math.max(Ee*(Ae+1),rn/6):L=0}(0,l.l_)(p,"_setTimeoutOverride",function(){return I.set},function(e){I=Kn(e,I.clear)}),(0,l.l_)(p,"_clearTimeoutOverride",function(){return I.clear},function(e){I=Kn(I.set,e)})}),b}return m}(Ce.i);const or=sr}}]);
