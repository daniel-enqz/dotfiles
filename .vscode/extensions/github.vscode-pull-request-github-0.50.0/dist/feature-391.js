"use strict";exports.id=391,exports.ids=[391],exports.modules={3391:(cr,Vn,nn)=>{nn.r(Vn),nn.d(Vn,{BE_PROFILE:()=>ee,NRT_PROFILE:()=>ne,PostChannel:()=>sr,RT_PROFILE:()=>bn});var Ce=nn(7421),An=nn(9141),fn=nn(1782),vn=nn(7954),he=nn(7624),y=nn(5705),l=nn(4869),en=nn(9251),dn=nn(8452),Tn=nn(9339),ke=nn(7951),bn="REAL_TIME",ne="NEAR_REAL_TIME",ee="BEST_EFFORT",Qn="POST",He="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",In="drop",Oe="send",re="requeue",Le="rspFail",ze="oth",Ke="no-cache, no-store",ie="application/x-json-stream",te="cache-control",Nn="content-type",Fe="kill-tokens",ae="kill-duration",Ue="kill-duration-seconds",ue="time-delta-millis",Pn="client-version",oe="client-id",Wn="time-delta-to-apply-millis",Xn="upload-time",jn="apikey",Bn="AuthMsaDeviceTicket",se="AuthXToken",lr="sdk-version",ye="NoResponseBody",On="msfpc";function fe(v){var m=(v.ext||{}).intweb;return m&&(0,y.Sn)(m[On])?m[On]:null}function ce(v){for(var m=null,A=0;m===null&&A<v.length;A++)m=fe(v[A]);return m}var Ln=function(){function v(m,A){var s=A?[].concat(A):[],k=this,C=ce(s);k.iKey=function(){return m},k.Msfpc=function(){return C||""},k.count=function(){return s.length},k.events=function(){return s},k.addEvent=function(c){return c?(s.push(c),C||(C=fe(c)),!0):!1},k.split=function(c,O){var z;if(c<s.length){var _=s.length-c;(0,l.le)(O)||(_=O<_?O:_),z=s.splice(c,_),C=ce(s)}return new v(m,z)}}return v.create=function(m,A){return new v(m,A)},v}(),_e=nn(1550),De=20,qe=3984588,le=65e3,ve=2e6,Qe=Math.min(ve,le),de="metadata",zn="f",Ie=/\./,Ne=function(){function v(m,A,s,k){var C="data",c="baseData",O="ext",z=!!k,_=!0,Z=A,rn={};(0,An.Z)(v,this,function(U){U.createPayload=function(x,R,F,q,w,H){return{apiKeys:[],payloadBlob:"",overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:x,isTeardown:R,isSync:F,isBeacon:q,sendType:H,sendReason:w}},U.appendPayload=function(x,R,F){var q=x&&R&&!x.overflow;return q&&(0,fn.Lm)(m,function(){return"Serializer:appendPayload"},function(){for(var w=R.events(),H=x.payloadBlob,N=x.numEvents,L=!1,K=[],W=[],B=x.isBeacon,T=B?le:qe,Y=B?Qe:ve,Q=0,J=0;Q<w.length;){var I=w[Q];if(I){if(N>=F){x.overflow=R.split(Q);break}var p=U.getEventBlob(I);if(p&&p.length<=Y){var j=p.length,pn=H.length;if(pn+j>T){x.overflow=R.split(Q);break}H&&(H+=`
`),H+=p,J++,J>De&&(H.substr(0,1),J=0),L=!0,N++}else p?K.push(I):W.push(I),w.splice(Q,1),Q--}Q++}if(K&&K.length>0&&x.sizeExceed.push(Ln.create(R.iKey(),K)),W&&W.length>0&&x.failedEvts.push(Ln.create(R.iKey(),W)),L){x.batches.push(R),x.payloadBlob=H,x.numEvents=N;var V=R.iKey();(0,l.UA)(x.apiKeys,V)===-1&&x.apiKeys.push(V)}},function(){return{payload:x,theBatch:{iKey:R.iKey(),evts:R.events()},max:F}}),q},U.getEventBlob=function(x){try{return(0,fn.Lm)(m,function(){return"Serializer.getEventBlob"},function(){var R={};R.name=x.name,R.time=x.time,R.ver=x.ver,R.iKey="o:"+(0,y.jM)(x.iKey);var F={},q=x[O];q&&(R[O]=F,(0,l.rW)(q,function(N,L){var K=F[N]={};D(L,K,"ext."+N,!0,null,null,!0)}));var w=R[C]={};w.baseType=x.baseType;var H=w[c]={};return D(x.baseData,H,c,!1,[c],function(N,L,K){ge(F,N,L,K)},_),D(x.data,w,C,!1,[],function(N,L,K){ge(F,N,L,K)},_),JSON.stringify(R)},function(){return{item:x}})}catch(R){return null}};function X(x,R){var F=rn[x];return F===void 0&&(x.length>=7&&(F=(0,l.xe)(x,"ext.metadata")||(0,l.xe)(x,"ext.web")),rn[x]=F),F}function D(x,R,F,q,w,H,N){(0,l.rW)(x,function(L,K){var W=null;if(K||(0,y.Sn)(K)){var B=F,T=L,Y=w,Q=R;if(z&&!q&&Ie.test(L)){var J=L.split("."),I=J.length;if(I>1){Y&&(Y=Y.slice());for(var p=0;p<I-1;p++){var j=J[p];Q=Q[j]=Q[j]||{},B+="."+j,Y&&Y.push(j)}T=J[I-1]}}var pn=q&&X(B,T);if(!pn&&Z&&Z.handleField(B,T)?W=Z.value(B,T,K,s):W=(0,y.yj)(T,K,s),W){var V=W.value;if(Q[T]=V,H&&H(Y,T,W),N&&typeof V=="object"&&!(0,l.kJ)(V)){var an=Y;an&&(an=an.slice(),an.push(T)),D(K,V,B+"."+T,q,an,H,N)}}}})}})}return v}();function ge(v,m,A,s){if(s&&v){var k=(0,y.Vv)(s.value,s.kind,s.propertyType);if(k>-1){var C=v[de];C||(C=v[de]={f:{}});var c=C[zn];if(c||(c=C[zn]={}),m)for(var O=0;O<m.length;O++){var z=m[O];c[z]||(c[z]={f:{}});var _=c[z][zn];_||(_=c[z][zn]={}),c=_}c=c[A]={},(0,l.kJ)(s.value)?c.a={t:k}:c.t=k}}}var Pe=.8,We=1.2,me=3e3,Xe=6e5;function je(v){return!(v>=300&&v<500&&v!=408&&v!=429||v==501||v==505)}function Se(v){var m=0,A=me*Pe,s=me*We,k=Math.floor(Math.random()*(s-A))+A;return m=Math.pow(2,v)*k,Math.min(m,Xe)}var Be=1e3,Je=function(){function v(){var m={};function A(s){var k=[];return s&&(0,l.tO)(s,function(C){k.push((0,l.nd)(C))}),k}(0,An.Z)(v,this,function(s){s.setKillSwitchTenants=function(k,C){if(k&&C)try{var c=A(k.split(","));if(C==="this-request-only")return c;for(var O=parseInt(C,10)*Be,z=0;z<c.length;++z)m[c[z]]=(0,l.m6)()+O}catch(_){return[]}return[]},s.isTenantKilled=function(k){var C=m,c=(0,l.nd)(k);return C[c]!==void 0&&C[c]>(0,l.m6)()?!0:(delete C[c],!1)}})}return v}();const Ze=Je;var Ye=function(){function v(){var m=!0,A=!0,s=!0,k="use-collector-delta",C=!1;(0,An.Z)(v,this,function(c){c.allowRequestSending=function(){return m},c.firstRequestSent=function(){s&&(s=!1,C||(m=!1))},c.shouldAddClockSkewHeaders=function(){return A},c.getClockSkewHeaderValue=function(){return k},c.setClockSkew=function(O){C||(O?(k=O,A=!0,C=!0):A=!1,m=!0)}})}return v}();const Ge=Ye;var gn,Jn="sendAttempt",pe="&"+ye+"=true",$e=(gn={},gn[1]=re,gn[100]=re,gn[200]="sent",gn[8004]=In,gn[8003]=In,gn),Zn={},Yn={};function mn(v,m,A){Zn[v]=m,A!==!1&&(Yn[m]=v)}mn(Bn,Bn,!1),mn(Pn,Pn),mn(oe,"Client-Id"),mn(jn,jn),mn(Wn,Wn),mn(Xn,Xn),mn(se,se);function xe(v){try{return v.responseText}catch(m){}return""}function Me(v,m){var A=!1;if(v&&m){var s=(0,l.FY)(v);if(s&&s.length>0)for(var k=m.toLowerCase(),C=0;C<s.length;C++){var c=s[C];if(c&&(0,l.nr)(m,c)&&c.toLowerCase()===k){A=!0;break}}}return A}function En(v,m,A,s){m&&A&&A.length>0&&(s&&Zn[m]?(v.hdrs[Zn[m]]=A,v.useHdrs=!0):v.url+="&"+m+"="+A)}var Ve=function(){function v(m,A,s,k,C){this._responseHandlers=[];var c="?cors=true&"+Nn.toLowerCase()+"="+ie,O=new Ze,z=!1,_=new Ge,Z=!1,rn=0,U,X,D,x=!0,R=[],F={},q=[],w=null,H=!1,N,L=!1,K=!1,W,B;(0,An.Z)(v,this,function(T){var Y=!0;T.initialize=function(n,i,t,u,f){var b;f||(f={}),c=n+c,K=(0,l.o8)(f.avoidOptions)?!0:!f.avoidOptions,D=i,N=i.getCookieMgr(),H=!D.config.disableEventTimings;var M=!!D.config.enableCompoundKey;U=t;var h=f.valueSanitizer,E=f.stringifyObjects;(0,l.o8)(f.enableCompoundKey)||(M=!!f.enableCompoundKey),W=f.xhrTimeout,B=f.disableXhrSync,Z=!(0,en.b$)(),w=new Ne(D,h,E,M);var d=u,e=f.alwaysUseXhrOverride?u:null,r=f.alwaysUseXhrOverride?u:null;if(!u){x=!1;var a=(0,en.k$)();a&&a.protocol&&a.protocol.toLowerCase()==="file:"&&(Y=!1);var o=[];(0,en.b$)()?o=[2,1]:o=[1,2,3];var g=f.transports;g&&((0,l.hj)(g)?o=[g].concat(o):(0,l.kJ)(g)&&(o=g.concat(o))),u=Q(o,!1),d=Q(o,!0),u||U.diagLog().warnToConsole("No available transport to send events")}X=(b={},b[0]=u,b[1]=d||Q([1,2,3],!0),b[2]=e||Q([3,2],!0)||d||Q([1],!0),b[3]=r||Q([2,3],!0)||d||Q([1],!0),b)};function Q(n,i){for(var t=0,u=null,f=0;u==null&&f<n.length;)t=n[f],t===1?(0,en.cp)()?u=J:(0,en.Z3)()&&(u=p):t===2&&(0,en.JO)(i)?u=I:Z&&t===3&&(0,en.MF)()&&(u=pn),f++;return u?{_transport:t,_isSync:i,sendPOST:u}:null}T._getDbgPlgTargets=function(){return[X[0],O,w,X]};function J(n,i,t){var u=new XDomainRequest;u.open(Qn,n.urlString),n.timeout&&(u.timeout=n.timeout),u.onload=function(){var f=xe(u);j(i,200,{},f),Rn(f)},u.onerror=function(){j(i,400,{})},u.ontimeout=function(){j(i,500,{})},u.onprogress=function(){},t?u.send(n.data):C.set(function(){u.send(n.data)},0)}function I(n,i,t){var u,f=n.urlString,b=!1,M=!1,h=(u={body:n.data,method:Qn},u[He]=!0,u);t&&(h.keepalive=!0,n._sendReason===2&&(b=!0,f+=pe)),Y&&(h.credentials="include"),n.headers&&(0,l.FY)(n.headers).length>0&&(h.headers=n.headers),fetch(f,h).then(function(E){var d={},e="";E.headers&&E.headers.forEach(function(r,a){d[a]=r}),E.body&&E.text().then(function(r){e=r}),M||(M=!0,j(i,E.status,d,e),Rn(e))}).catch(function(E){M||(M=!0,j(i,0,{}))}),b&&!M&&(M=!0,j(i,200,{})),!M&&n.timeout>0&&C.set(function(){M||(M=!0,j(i,500,{}))},n.timeout)}function p(n,i,t){var u=n.urlString;function f(E,d,e){if(!E[e]&&d&&d.getResponseHeader){var r=d.getResponseHeader(e);r&&(E[e]=(0,l.nd)(r))}return E}function b(E){var d={};return E.getAllResponseHeaders?d=Hn(E.getAllResponseHeaders()):(d=f(d,E,ue),d=f(d,E,ae),d=f(d,E,Ue)),d}function M(E,d){j(i,E.status,b(E),d)}t&&n.disableXhrSync&&(t=!1);var h=(0,y.ot)(Qn,u,Y,!0,t,n.timeout);(0,l.rW)(n.headers,function(E,d){h.setRequestHeader(E,d)}),h.onload=function(){var E=xe(h);M(h,E),Rn(E)},h.onerror=function(){M(h)},h.ontimeout=function(){M(h)},h.send(n.data)}function j(n,i,t,u){try{n(i,t,u)}catch(f){(0,Tn.kP)(U.diagLog(),2,518,(0,en.eU)(f))}}function pn(n,i,t){var u=n,f=200,b=u._thePayload,M=n.urlString+pe;try{var h=(0,en.jW)();if(!h.sendBeacon(M,n.data))if(b){var E=[];(0,l.tO)(b.batches,function(d){if(E&&d&&d.count()>0){for(var e=d.events(),r=0;r<e.length;r++)if(!h.sendBeacon(M,w.getEventBlob(e[r]))){E.push(d.split(r));break}}else E.push(d.split(0))}),on(E,8003,b.sendType,!0)}else f=0}catch(d){U.diagLog().warnToConsole("Failed to send telemetry using sendBeacon API. Ex:"+(0,en.eU)(d)),f=0}finally{j(i,f,{},"")}}function V(n){return n===2||n===3}function an(n){return L&&V(n)&&(n=2),n}T.addQueryStringParameter=function(n,i){for(var t=0;t<R.length;t++)if(R[t].name===n){R[t].value=i;return}R.push({name:n,value:i})},T.addHeader=function(n,i){F[n]=i},T.canSendRequest=function(){return wn()&&_.allowRequestSending()},T.sendQueuedRequests=function(n,i){(0,l.o8)(n)&&(n=0),L&&(n=an(n),i=2),Cn(q,n,0)&&xn(ln(),0,!1,n,i||0)},T.isCompletelyIdle=function(){return!z&&rn===0&&q.length===0},T.setUnloading=function(n){L=n},T.addBatch=function(n){if(n&&n.count()>0){if(O.isTenantKilled(n.iKey()))return!1;q.push(n)}return!0},T.teardown=function(){q.length>0&&xn(ln(),0,!0,2,2)},T.pause=function(){z=!0},T.resume=function(){z=!1,T.sendQueuedRequests(0,4)},T.sendSynchronousBatch=function(n,i,t){n&&n.count()>0&&((0,l.le)(i)&&(i=1),L&&(i=an(i),t=2),xn([n],0,!1,i,t||0))};function wn(){return!z&&rn<A}function ln(){var n=q;return q=[],n}function Cn(n,i,t){var u=!1;return n&&n.length>0&&!z&&X[i]&&w&&(u=i!==0||wn()&&(t>0||_.allowRequestSending())),u}function $(n){var i={};return n&&(0,l.tO)(n,function(t,u){i[u]={iKey:t.iKey(),evts:t.events()}}),i}function xn(n,i,t,u,f){if(!(!n||n.length===0)){if(z){on(n,1,u);return}u=an(u);try{var b=n,M=u!==0;(0,fn.Lm)(D,function(){return"HttpManager:_sendBatches"},function(h){h&&(n=n.slice(0));for(var E=[],d=null,e=(0,y.hK)(),r=X[u]||(M?X[1]:X[0]),a=(L||V(u)||r&&r._transport===3)&&un();Cn(n,u,i);){var o=n.shift();o&&o.count()>0&&(O.isTenantKilled(o.iKey())?E.push(o):(d=d||w.createPayload(i,t,M,a,f,u),w.appendPayload(d,o,m)?d.overflow!==null&&(n=[d.overflow].concat(n),d.overflow=null,hn(d,e,(0,y.hK)(),f),e=(0,y.hK)(),d=null):(hn(d,e,(0,y.hK)(),f),e=(0,y.hK)(),n=[o].concat(n),d=null)))}d&&hn(d,e,(0,y.hK)(),f),n.length>0&&(q=n.concat(q)),on(E,8004,u)},function(){return{batches:$(b),retryCount:i,isTeardown:t,isSynchronous:M,sendReason:f,useSendBeacon:V(u),sendType:u}},!M)}catch(h){(0,Tn.kP)(U.diagLog(),2,48,"Unexpected Exception sending batch: "+(0,en.eU)(h))}}}function Mn(n,i){var t={url:c,hdrs:{},useHdrs:!1};i?(t.hdrs=(0,y.l7)(t.hdrs,F),t.useHdrs=(0,l.FY)(t.hdrs).length>0):(0,l.rW)(F,function(h,E){Yn[h]?En(t,Yn[h],E,!1):(t.hdrs[h]=E,t.useHdrs=!0)}),En(t,oe,"NO_AUTH",i),En(t,Pn,y.vs,i);var u="";(0,l.tO)(n.apiKeys,function(h){u.length>0&&(u+=","),u+=h}),En(t,jn,u,i),En(t,Xn,(0,l.m6)().toString(),i);var f=Dn(n);if((0,y.Sn)(f)&&(t.url+="&ext.intweb.msfpc="+f),_.shouldAddClockSkewHeaders()&&En(t,Wn,_.getClockSkewHeaderValue(),i),D.getWParam){var b=D.getWParam();b>=0&&(t.url+="&w="+b)}for(var M=0;M<R.length;M++)t.url+="&"+R[M].name+"="+R[M].value;return t}function un(){return!x&&Z&&(0,en.MF)()}function cn(n,i,t){n[i]=n[i]||{},n[i][U.identifier]=t}function hn(n,i,t,u){if(n&&n.payloadBlob&&n.payloadBlob.length>0){var f=!!T.sendHook,b=X[n.sendType];!V(n.sendType)&&n.isBeacon&&n.sendReason===2&&(b=X[2]||X[3]||b);var M=K;(n.isBeacon||b._transport===3)&&(M=!1);var h=Mn(n,M);M=M||h.useHdrs;var E=(0,y.hK)();(0,fn.Lm)(D,function(){return"HttpManager:_doPayloadSend"},function(){for(var d=0;d<n.batches.length;d++)for(var e=n.batches[d],r=e.events(),a=0;a<r.length;a++){var o=r[a];if(H){var g=o.timings=o.timings||{};cn(g,"sendEventStart",E),cn(g,"serializationStart",i),cn(g,"serializationCompleted",t)}o[Jn]>0?o[Jn]++:o[Jn]=1}on(n.batches,1e3+(u||0),n.sendType,!0);var S={data:n.payloadBlob,urlString:h.url,headers:h.hdrs,_thePayload:n,_sendReason:u,timeout:W};(0,l.o8)(B)||(S.disableXhrSync=!!B),M&&(Me(S.headers,te)||(S.headers[te]=Ke),Me(S.headers,Nn)||(S.headers[Nn]=ie));var P=null;b&&(P=function(G){_.firstRequestSent();var tn=function($n,fr){yn($n,fr,n,u)},sn=n.isTeardown||n.isSync;try{b.sendPOST(G,tn,sn),T.sendListener&&T.sendListener(S,G,sn,n.isBeacon)}catch($n){U.diagLog().warnToConsole("Unexpected exception sending payload. Ex:"+(0,en.eU)($n)),j(tn,0,{})}}),(0,fn.Lm)(D,function(){return"HttpManager:_doPayloadSend.sender"},function(){if(P)if(n.sendType===0&&rn++,f&&!n.isBeacon&&b._transport!==3){var G={data:S.data,urlString:S.urlString,headers:(0,y.l7)({},S.headers),timeout:S.timeout,disableXhrSync:S.disableXhrSync},tn=!1;(0,fn.Lm)(D,function(){return"HttpManager:_doPayloadSend.sendHook"},function(){try{T.sendHook(G,function(sn){tn=!0,!x&&!sn._thePayload&&(sn._thePayload=sn._thePayload||S._thePayload,sn._sendReason=sn._sendReason||S._sendReason),P(sn)},n.isSync||n.isTeardown)}catch(sn){tn||P(S)}})}else P(S)})},function(){return{thePayload:n,serializationStart:i,serializationCompleted:t,sendReason:u}},n.isSync)}n.sizeExceed&&n.sizeExceed.length>0&&on(n.sizeExceed,8003,n.sendType),n.failedEvts&&n.failedEvts.length>0&&on(n.failedEvts,8002,n.sendType)}function Un(n,i){H&&(0,l.tO)(n,function(t){var u=t.timings=t.timings||{};cn(u,"sendEventCompleted",i)})}function yn(n,i,t,u){var f=9e3,b=null,M=!1,h=!1;try{var E=!0;if(typeof n!==_e.jA){if(i){_.setClockSkew(i[ue]);var d=i[ae]||i["kill-duration-seconds"];(0,l.tO)(O.setKillSwitchTenants(i[Fe],d),function(r){(0,l.tO)(t.batches,function(a){if(a.iKey()===r){b=b||[];var o=a.split(0);t.numEvents-=o.count(),b.push(o)}})})}if(n==200||n==204){f=200;return}(!je(n)||t.numEvents<=0)&&(E=!1),f=9e3+n%1e3}if(E){f=100;var e=t.retryCnt;t.sendType===0&&(e<s?(M=!0,kn(function(){t.sendType===0&&rn--,xn(t.batches,e+1,t.isTeardown,L?2:t.sendType,5)},L,Se(e))):(h=!0,L&&(f=8001)))}}finally{M||(_.setClockSkew(),_n(t,f,u,h)),on(b,8004,t.sendType)}}function _n(n,i,t,u){try{u&&U._backOffTransmission(),i===200&&(!u&&!n.isSync&&U._clearBackOff(),Gn(n.batches)),on(n.batches,i,n.sendType,!0)}finally{n.sendType===0&&(rn--,t!==5&&T.sendQueuedRequests(n.sendType,t))}}function Gn(n){if(H){var i=(0,y.hK)();(0,l.tO)(n,function(t){t&&t.count()>0&&Un(t.events(),i)})}}function kn(n,i,t){i?n():C.set(n,t)}function Hn(n){var i={};if((0,l.HD)(n)){var t=(0,l.nd)(n).split(/[\r\n]+/);(0,l.tO)(t,function(u){if(u){var f=u.indexOf(": ");if(f!==-1){var b=(0,l.nd)(u.substring(0,f)).toLowerCase(),M=(0,l.nd)(u.substring(f+1));i[b]=M}else i[(0,l.nd)(u)]=1}})}return i}function Dn(n){for(var i=0;i<n.batches.length;i++){var t=n.batches[i].Msfpc();if(t)return encodeURIComponent(t)}return""}function Rn(n){var i=T._responseHandlers;try{for(var t=0;t<i.length;t++)try{i[t](n)}catch(f){(0,Tn.kP)(U.diagLog(),1,519,"Response handler failed: "+f)}if(n){var u=JSON.parse(n);(0,y.Sn)(u.webResult)&&(0,y.Sn)(u.webResult[On])&&N.set("MSFPC",u.webResult[On],365*86400)}}catch(f){}}function on(n,i,t,u){if(n&&n.length>0&&k){var f=k[qn(i)];if(f){var b=t!==0;(0,fn.Lm)(D,function(){return"HttpManager:_sendBatchesNotification"},function(){kn(function(){try{f.call(k,n,i,b,t)}catch(M){(0,Tn.kP)(U.diagLog(),1,74,"send request notification failed: "+M)}},u||b,0)},function(){return{batches:$(n),reason:i,isSync:b,sendSync:u,sendType:t}},!b)}}}function qn(n){var i=$e[n];return(0,y.Sn)(i)||(i=ze,n>=9e3&&n<=9999?i=Le:n>=8e3&&n<=8999?i=In:n>=1e3&&n<=1999&&(i=Oe)),i}})}return v}();function nr(v,m){for(var A=[],s=2;s<arguments.length;s++)A[s-2]=arguments[s];return setTimeout(v,m,A)}function er(v){clearTimeout(v)}function Kn(v,m){return{set:v||nr,clear:m||er}}var rr=.25,Ee=500,ir=20,Re=6,Ae=2,tr=4,Te=2,ar=1,Sn="eventsDiscarded",Fn="overrideInstrumentationKey",be="maxEventRetryAttempts",we="maxUnloadEventRetryAttempts",ur="addUnloadCb",or=function(v){(0,Ce.ne)(m,v);function m(){var A=v.call(this)||this;A.identifier="PostChannel",A.priority=1011,A.version="3.2.3";var s,k=!1,C=[],c=null,O=!1,z=0,_=500,Z=0,rn=1e4,U={},X=bn,D=null,x=null,R=0,F=0,q,w,H={},N,L,K=-1,W,B=!0,T=!1,Y=Re,Q=Ae,J,I;return(0,An.Z)(m,A,function(p,j){xn(),p._getDbgPlgTargets=function(){return[w]},p.initialize=function(e,r,a){(0,fn.Lm)(r,function(){return"PostChannel:initialize"},function(){var o=r;j.initialize(e,r,a);try{var g=!!r[ur];J=(0,vn.jU)((0,he.J)(p.identifier),r.evtNamespace&&r.evtNamespace());var S=p._getTelCtx();e.extensionConfig[p.identifier]=e.extensionConfig[p.identifier]||{},s=S.getExtCfg(p.identifier),I=Kn(s.setTimeoutOverride,s.clearTimeoutOverride),B=!s.disableOptimizeObj&&(0,y.mJ)(),pn(o),s.eventsLimitInMem>0&&(rn=s.eventsLimitInMem),s.immediateEventLimit>0&&(_=s.immediateEventLimit),s.autoFlushEventsLimit>0&&(N=s.autoFlushEventsLimit),(0,l.hj)(s[be])&&(Y=s[be]),(0,l.hj)(s[we])&&(Q=s[we]),d(),s.httpXHROverride&&s.httpXHROverride.sendPOST&&(q=s.httpXHROverride),(0,y.Sn)(e.anonCookieName)&&w.addQueryStringParameter("anoncknm",e.anonCookieName),w.sendHook=s.payloadPreprocessor,w.sendListener=s.payloadListener;var P=s.overrideEndpointUrl?s.overrideEndpointUrl:e.endpointUrl;p._notificationManager=e.extensionConfig.NotificationManager,w.initialize(P,p.core,p,q,s);var G=e.disablePageUnloadEvents||[];(0,vn.c9)(V,G,J),(0,vn.TJ)(V,G,J),(0,vn.nD)(an,e.disablePageShowEvents,J)}catch(tn){throw p.setInitialized(!1),tn}},function(){return{coreConfig:e,core:r,extensions:a}})},p.processTelemetry=function(e,r){(0,y.if)(e,p.identifier),r=p._getTelCtx(r);var a=r.getExtCfg(p.identifier),o=!!s.disableTelemetry;a&&(o=o||!!a.disableTelemetry);var g=e;!o&&!k&&(s[Fn]&&(g.iKey=s[Fn]),a&&a[Fn]&&(g.iKey=a[Fn]),wn(g,!0),T?cn(2,2):$()),p.processNext(g,r)},p._doTeardown=function(e,r){cn(2,2),k=!0,w.teardown(),(0,vn.JA)(null,J),(0,vn.C9)(null,J),(0,vn.Yl)(null,J),xn()};function pn(e){var r=e.getWParam;e.getWParam=function(){var a=0;return s.ignoreMc1Ms0CookieProcessing&&(a=a|2),a|r()}}function V(e){var r=e||(0,en.Jj)().event;r.type!=="beforeunload"&&(T=!0,w.setUnloading(T)),cn(2,2)}function an(e){T=!1,w.setUnloading(T)}function wn(e,r){if(e.sendAttempt||(e.sendAttempt=0),e.latency||(e.latency=1),e.ext&&e.ext.trace&&delete e.ext.trace,e.ext&&e.ext.user&&e.ext.user.id&&delete e.ext.user.id,B&&(e.ext=(0,l.Ax)(e.ext),e.baseData&&(e.baseData=(0,l.Ax)(e.baseData)),e.data&&(e.data=(0,l.Ax)(e.data))),e.sync){if(R||O)e.latency=3,e.sync=!1;else if(w){B&&(e=(0,l.Ax)(e)),w.sendSynchronousBatch(Ln.create(e.iKey,[e]),e.sync===!0?1:e.sync,3);return}}var a=e.latency,o=Z,g=rn;a===4&&(o=z,g=_);var S=!1;if(o<g)S=!_n(e,r);else{var P=1,G=ir;a===4&&(P=4,G=1),S=!0,Gn(e.iKey,e.latency,P,G)&&(S=!_n(e,r))}S&&t(Sn,[e],dn.h.QueueFull)}p.setEventQueueLimits=function(e,r){rn=e>0?e:1e4,N=r>0?r:0,d();var a=Z>e;if(!a&&L>0)for(var o=1;!a&&o<=3;o++){var g=H[o];g&&g.batches&&(0,l.tO)(g.batches,function(S){S&&S.count()>=L&&(a=!0)})}yn(!0,a)},p.pause=function(){un(),O=!0,w.pause()},p.resume=function(){O=!1,w.resume(),$()},p.addResponseHandler=function(e){w._responseHandlers.push(e)},p._loadTransmitProfiles=function(e){on(),(0,l.rW)(e,function(r,a){var o=a.length;if(o>=2){var g=o>2?a[2]:0;if(a.splice(0,o-2),a[1]<0&&(a[0]=-1),a[1]>0&&a[0]>0){var S=a[0]/a[1];a[0]=Math.ceil(S)*a[1]}g>=0&&a[1]>=0&&g>a[1]&&(g=a[1]),a.push(g),U[r]=a}})},p.flush=function(e,r,a){if(e===void 0&&(e=!0),!O)if(a=a||1,e)c==null?(un(),Hn(1,0,a),c=Mn(function(){c=null,Dn(r,a)},0)):C.push(r);else{var o=un();ln(1,1,a),r!=null&&r(),o&&$()}},p.setMsaAuthTicket=function(e){w.addHeader(Bn,e)},p.hasEvents=Cn,p._setTransmitProfile=function(e){X!==e&&U[e]!==void 0&&(un(),X=e,$())};function ln(e,r,a){var o=Hn(e,r,a);return w.sendQueuedRequests(r,a),o}function Cn(){return Z>0}function $(){if(K>=0&&Hn(K,0,W)&&w.sendQueuedRequests(0,W),z>0&&!x&&!O){var e=U[X][2];e>=0&&(x=Mn(function(){x=null,ln(4,0,1),$()},e))}var r=U[X][1];!D&&!c&&r>=0&&!O&&(Cn()?D=Mn(function(){D=null,ln(F===0?3:1,0,1),F++,F%=2,$()},r):F=0)}p._backOffTransmission=function(){R<tr&&(R++,un(),$())},p._clearBackOff=function(){R&&(R=0,un(),$())};function xn(){s=null,k=!1,C=[],c=null,O=!1,z=0,_=500,Z=0,rn=1e4,U={},X=bn,D=null,x=null,R=0,F=0,q=null,H={},N=void 0,L=0,K=-1,W=null,B=!0,T=!1,Y=Re,Q=Ae,J=null,I=Kn(),w=new Ve(Ee,Te,ar,{requeue:n,send:f,sent:b,drop:M,rspFail:h,oth:E},I),qn(),hn(),d()}function Mn(e,r){r===0&&R&&(r=1);var a=1e3;return R&&(a=Se(R-1)),I.set(e,r*a)}function un(){return D!==null?(I.clear(D),D=null,F=0,!0):!1}function cn(e,r){un(),c&&(I.clear(c),c=null),O||ln(1,e,r)}function hn(){H[4]={batches:[],iKeyMap:{}},H[3]={batches:[],iKeyMap:{}},H[2]={batches:[],iKeyMap:{}},H[1]={batches:[],iKeyMap:{}}}function Un(e,r,a){var o=H[r];o||(r=1,o=H[r]);var g=o.iKeyMap[e];return!g&&a&&(g=Ln.create(e),o.batches.push(g),o.iKeyMap[e]=g),g}function yn(e,r){w.canSendRequest()&&!R&&(N>0&&Z>N&&(r=!0),r&&c==null&&p.flush(e,null,20))}function _n(e,r){B&&(e=(0,l.Ax)(e));var a=e.latency,o=Un(e.iKey,a,!0);return o.addEvent(e)?(a!==4?(Z++,r&&e.sendAttempt===0&&yn(!e.sync,L>0&&o.count()>=L)):z++,!0):!1}function Gn(e,r,a,o){for(;a<=r;){var g=Un(e,r,!0);if(g&&g.count()>0){var S=g.split(0,o),P=S.count();if(P>0)return a===4?z-=P:Z-=P,u(Sn,[S],dn.h.QueueFull),!0}a++}return kn(),!1}function kn(){for(var e=0,r=0,a=function(g){var S=H[g];S&&S.batches&&(0,l.tO)(S.batches,function(P){g===4?e+=P.count():r+=P.count()})},o=1;o<=4;o++)a(o);Z=r,z=e}function Hn(e,r,a){var o=!1,g=r===0;return!g||w.canSendRequest()?(0,fn.Lm)(p.core,function(){return"PostChannel._queueBatches"},function(){for(var S=[],P=4;P>=e;){var G=H[P];G&&G.batches&&G.batches.length>0&&((0,l.tO)(G.batches,function(tn){w.addBatch(tn)?o=o||tn&&tn.count()>0:S=S.concat(tn.events()),P===4?z-=tn.count():Z-=tn.count()}),G.batches=[],G.iKeyMap={}),P--}S.length>0&&t(Sn,S,dn.h.KillSwitch),o&&K>=e&&(K=-1,W=0)},function(){return{latency:e,sendType:r,sendReason:a}},!g):(K=K>=0?Math.min(K,e):e,W=Math.max(W,a)),o}function Dn(e,r){ln(1,0,r),kn(),Rn(function(){e&&e(),C.length>0?c=Mn(function(){c=null,Dn(C.shift(),r)},0):(c=null,$())})}function Rn(e){w.isCompletelyIdle()?e():c=Mn(function(){c=null,Rn(e)},rr)}function on(){un(),qn(),X=bn,$()}function qn(){U={},U[bn]=[2,1,0],U[ne]=[6,3,0],U[ee]=[18,9,0]}function n(e,r){var a=[],o=Y;T&&(o=Q),(0,l.tO)(e,function(g){g&&g.count()>0&&(0,l.tO)(g.events(),function(S){S&&(S.sync&&(S.latency=4,S.sync=!1),S.sendAttempt<o?((0,y.if)(S,p.identifier),wn(S,!1)):a.push(S))})}),a.length>0&&t(Sn,a,dn.h.NonRetryableStatus),T&&cn(2,2)}function i(e,r){var a=p._notificationManager||{},o=a[e];if(o)try{o.apply(a,r)}catch(g){(0,Tn.kP)(p.diagLog(),1,74,e+" notification failed: "+g)}}function t(e,r){for(var a=[],o=2;o<arguments.length;o++)a[o-2]=arguments[o];r&&r.length>0&&i(e,[r].concat(a))}function u(e,r){for(var a=[],o=2;o<arguments.length;o++)a[o-2]=arguments[o];r&&r.length>0&&(0,l.tO)(r,function(g){g&&g.count()>0&&i(e,[g.events()].concat(a))})}function f(e,r,a){e&&e.length>0&&i("eventsSendRequest",[r>=1e3&&r<=1999?r-1e3:0,a!==!0])}function b(e,r){u("eventsSent",e,r),$()}function M(e,r){u(Sn,e,r>=8e3&&r<=8999?r-8e3:dn.h.Unknown)}function h(e){u(Sn,e,dn.h.NonRetryableStatus),$()}function E(e,r){u(Sn,e,dn.h.Unknown),$()}function d(){!s||!s.disableAutoBatchFlushLimit?L=Math.max(Ee*(Te+1),rn/6):L=0}(0,l.l_)(p,"_setTimeoutOverride",function(){return I.set},function(e){I=Kn(e,I.clear)}),(0,l.l_)(p,"_clearTimeoutOverride",function(){return I.clear},function(e){I=Kn(I.set,e)})}),A}return m}(ke.i);const sr=or}};
